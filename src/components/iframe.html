<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <style>
    body>div>div {
      margin-bottom: 0.3rem;
      cursor: pointer;
      color: #fff;
      padding: 0.3rem 0.8rem;
      border: 1px solid #00c1de;
      font-size: 0.8rem;
      cursor: pointer;
      background: hsla(192, 70%, 34%, 0.7);
      display: inline-block;
    }
  </style>
  <title>测试IFrame</title>
</head>

<body>
  <div style="position:absolute;top:0;left:0;right:0;bottom:220;">
    <!-- <iframe name="mapFrame" src="../index.html" style="width: 100%;height:600px;"></iframe> -->
    <iframe name="mapFrame" src="http://101.42.228.120:8092/nl/" style="width: 100%;height:600px;"></iframe>
    <br />


    <div onclick='flyToXiBei()'>缩放到西北区域</div>
    <div onclick='addPopup()'>addPopup</div>
    <br />
    <div onclick='addCustomStyleLine()'>添加自定义样式线(3秒后消失)</div>
    <div onclick='addCustomStyleLineWithIcon()'>添加自定义样式线（图标填充_5秒后消失）</div>
    <div onclick='clearCustomStyleLine()'>删除自定义样式线</div>
    <br />
    <div onclick='addTarget()'>addTarget</div>
    <div onclick='addTargetHistory()'>addTargetHistory</div>
    <div onclick='setStations()'>setStations</div>
    <br />
    <div onclick='clearTarget()'>clearTarget</div>
    <div onclick='clearStations()'>clearStations</div>
    <div onclick='clearTargetHistory()'>clearTargetHistory</div>
    <div onclick="clearMap()">删除所有要素</div>
    <br />
    <div onclick='enableDrawTool()'>enableDrawTool</div>
    <div onclick='disableDrawTool()'>disableDrawTool</div>
    <br />

    <div onclick='animateReceiveData()'>animateReceiveData</div>
    <div onclick='stopAnimate()'>stopAnimate</div>

    <br />


  </div>
  <script type="text/javascript">

    //缩放到西北区域
    function flyToXiBei() {
      mapFrame.postMessage({
        cmd: 'flyTo',//地图缩放到指定位置和层级命名
        params: {
          x: 86.95,
          y: 39.355,
          level: 7
        }
      }, '*');
    }


    //绘制路径
    function enableDrawTool() {

      window.mapFrame.postMessage(
        {
          cmd: "enableDrawTool", //在地图中添加站点
          params: {
          },
        },
        "*"
      );
    }

    //结束绘制
    function disableDrawTool() {

      window.mapFrame.postMessage(
        {
          cmd: "disableDrawTool", //在地图中添加站点
          params: {
          },
        },
        "*"
      );
    }

    //添加目标
    let globalId = 0;
    function addTarget() {
      let targetData = {
        id: globalId++,
        properties: { 时间: "2022-02-28", 运行状态: "在线", 姿态角: "140", 速度: "200KM/H" },
        coordinates: [85.03, 40.21],
        styles: {
          isAlwaysShowPopop: true, //是否一直显示弹窗
        },
      }
      window.mapFrame.postMessage(
        {
          cmd: "addTarget", //在地图中添加站点
          params: {
            target: targetData,
            historyClickAble: true,
          },
        },
        "*"
      );
    }


    //添加目标轨迹
    function addTargetHistory() {
      let targetHistoryData = [
        {
          id: '111',
          properties: { 时间: "2022-02-28", 运行状态: "在线", 姿态角: "140", 速度: "200KM/H" },
          coordinates: [85.03, 40.21],
        },
        {
          id: 23,
          properties: { 时间: "2022-02-29", 运行状态: "在线", 姿态角: "120", 速度: "100KM/H" },
          coordinates: [86.03, 40.21],
        },
        {
          id: 33,
          properties: { 时间: "2022-03-28", 运行状态: "在线", 姿态角: "100", 速度: "220KM/H" },
          coordinates: [86.03, 41.21],
        },
      ];
      window.mapFrame.postMessage(
        {
          cmd: "addTargetHistory", //在地图中添加站点
          params: {
            history: targetHistoryData,
            historyClickAble: true,//轨迹点是否可点击，启用该参数后，点击轨迹点，会将所点击轨迹点对应的id及经纬度回传给主程序
          },
        },
        "*"
      );
    }


    //在指定位置添加弹框
    function addPopup() {
      let popData = {
        properties: { 时间: "2022-02-29", 运行状态: "在线", 姿态角: "120", 速度: "100KM/H" },
        coordinates: [86, 40.1],
      };
      window.mapFrame.postMessage(
        {
          cmd: "addPopup", //在地图中添加站点
          params: {
            popData: popData
          },
        },
        "*"
      );
    }


    //添加固定点数据接口
    function setStations() {
      let stationsData = [
        {
          id: '111',
          type: "",
          properties: { 站点名称: "测试站1", 运行状态: "在线" },//在弹框中显示的信息
          coordinates: [85.03, 39.21],
          styles: {
            isAlwaysShowPopop: false,//是否保持一直显示弹窗，当该属性为false时可通过点击固定站来切换弹窗的显示状态
            isDraggable: false,//是否可拖拽 默认为true
            lineColor: "green", //连接线颜色，默认为red
            lineWidth: 3, //连接线宽度,默认为3 
          },
        },
        {
          id: '31',
          properties: { 站点名称: "测试站2", 运行状态: "在线" },
          coordinates: [85.53, 39.41],
          styles: {
            isLine2Target: true, //是否在地图上绘制站点到目标之间的连接线，该参数默认true
            lineColor: "red", //连接线颜色
            lineWidth: 1, //连接线宽度
            isAlwaysShowPopop: true, //是否保持一直显示弹窗
          },
        },
        {
          id: '121',
          properties: { 站点名称: "测试站3", 运行状态: "在线" },
          coordinates: [87.35, 39.31],
          styles: {
            isLine2Target: false, //是否在地图上绘制站点到目标之间的连接线，该参数默认true
            lineColor: "red", //连接线颜色
            lineWidth: 1, //连接线宽度
            isAlwaysShowPopop: false, //是否保持一直显示弹窗，当该属性为false时可通过点击固定站来切换弹窗的显示状态
          },
        },
      ];
      window.mapFrame.postMessage(
        {
          cmd: "setStations", //在地图中添加站点
          params: {
            stations: stationsData,
          },
        },
        "*"
      );
    }

    //清除目标数据
    function clearTarget() {
      window.mapFrame.postMessage(
        {
          cmd: "clearTarget", //清除目标数据
          params: {
          },
        },
        "*"
      );
    }
    //清除全部站点
    function clearStations() {
      window.mapFrame.postMessage(
        {
          cmd: "clearStations", //清除全部站点
          params: {
          },
        },
        "*"
      );
    }

    //清除目标历史轨迹
    function clearTargetHistory() {
      window.mapFrame.postMessage(
        {
          cmd: "clearTargetHistory", //清除历史轨迹
          params: {
          },
        },
        "*"
      );
    }


    //清除地图上所有要素
    function clearMap() {
      mapFrame.postMessage({
        cmd: 'clearMap'//清除所有地图要素指令
      }, '*')
    }

    //添加自定义样式的线
    function addCustomStyleLine() {
      let coordinates = [[85.03, 39.21],
      [85.13, 38.21],
      [85.43, 39.61]];
      window.mapFrame.postMessage(
        {
          cmd: "addCustomStyleLine", //在地图中添加站点
          params: {
            coordinates: coordinates,
            styles: {
              lineColor: "#FF0099", //线颜色
              lineWidth: 5, //线宽度
              duration: 0,//线显示的时间（单位为毫秒），超过该时间后线自动消失。当该参数为0时，线永久显示
            }
          },
        },
        "*"
      );
    }
    //添加自定义样式的线(使用图标填充线样式)
    function addCustomStyleLineWithIcon() {
      let coordinates = [[85.03, 38.21],
      [85.13, 37.21],
      [85.43, 38.61]];
      window.mapFrame.postMessage(
        {
          cmd: "addCustomStyleLine", //在地图中添加站点
          params: {
            coordinates: coordinates,
            styles: {
              icon: "ring_red", //线颜色
              lineWidth: 16, //线宽度
              duration: 0,//线显示的时间（单位为毫秒），超过该时间后线自动消失。当该参数为0时，线永久显示
            }
          },
        },
        "*"
      );
    }
    ////清除自定义样式线
    function clearCustomStyleLine() {
      mapFrame.postMessage({
        cmd: 'clearCustomStyleLine'//清除自定义样式线
      }, '*')
    }

    //模拟接收数据的过程
    let animateInterval = null;
    function animateReceiveData() {
      if (animateInterval != null) {
        clearInterval(animateInterval);
        animateInterval = null;
      }
      setStations();
      let testData = [
        [86.05, 39.01],
        [86.05297435603154, 39.0112190881854],
        [86.05594881459817, 39.01243810084614],
        [86.05892337570155, 39.01365703797634],
        [86.06189803934333, 39.0148758995701],
        [86.06487280552511, 39.016094685621525],
        [86.06784767424854, 39.017313396124756],
        [86.07082264551526, 39.01853203107388],
        [86.07379771932695, 39.01975059046301],
        [86.07677289568518, 39.02096907428625],
        [86.0797481745916, 39.022187482537724],
        [86.08272355604785, 39.02340581521154],
        [86.08569904005559, 39.0246240723018],
        [86.0886746266164, 39.0258422538026],
        [86.09165031573193, 39.027060359708095],
        [86.09462610740378, 39.028278390012325],
        [86.09760200163362, 39.02949634470947],
        [86.10057799842306, 39.030714223793595],
        [86.10355409777371, 39.03193202725881],
        [86.10653029968722, 39.033149755099245],
        [86.10950660416519, 39.034367407309],
        [86.1124830112092, 39.03558498388217],
        [86.11545952082095, 39.03680248481286],
        [86.118436133002, 39.03801991009521],
        [86.12141284775397, 39.03923725972329],
        [86.12438966507851, 39.040454533691225],
        [86.1273665849772, 39.041671731993134],
        [86.13034360745166, 39.0428888546231],
        [86.13332073250349, 39.04410590157524],
        [86.13629796013431, 39.045322872843656],
        [86.13927529034574, 39.04653976842247],
        [86.14225272313938, 39.047756588305774],
        [86.14523025851683, 39.04897333248767],
        [86.14820789647969, 39.050190000962274],
        [86.15118563702956, 39.051406593723684],
        [86.15416348016805, 39.052623110766014],
        [86.15714142589678, 39.05383955208337],
        [86.16011947421731, 39.05505591766985],
        [86.16309762513129, 39.05627220751954],
        [86.16607587864026, 39.05748842162658],
        [86.16905423474586, 39.05870455998507],
        [86.17203269344964, 39.05992062258908],
        [86.17501125475323, 39.06113660943277],
        [86.1779899186582, 39.06235252051019],
        [86.18096868516619, 39.06356835581547],
        [86.1839475542787, 39.06478411534271],
        [86.18692652599741, 39.065999799086015],
        [86.18990560032384, 39.067215407039484],
        [86.19288477725962, 39.06843093919723],
        [86.1958640568063, 39.06964639555335],
        [86.19884343896548, 39.070861776101935],
        [86.20182292373875, 39.0720770808371],
        [86.20480251112767, 39.07329230975296],
        [86.20778220113384, 39.074507462843584],
        [86.21076199375882, 39.075722540103094],
        [86.21374188900421, 39.076937541525595],
        [86.21672188687155, 39.07815246710519],
        [86.21970198736246, 39.07936731683598],
        [86.22268219047847, 39.08058209071205],
        [86.22566249622116, 39.081796788727516],
        [86.22864290459214, 39.083011410876466],
        [86.23162341559292, 39.08422595715302],
        [86.23460402922511, 39.08544042755127],
        [86.23758474549027, 39.08665482206531],
        [86.24056556438994, 39.08786914068926],
        [86.24354648592575, 39.0890833834172],
        [86.24652751009916, 39.09029755024324],
        [86.24950863691181, 39.09151164116146],
        [86.25248986636524, 39.09272565616599],
        [86.25547119846104, 39.09393959525091],
        [86.25845263320069, 39.09515345841033],
        [86.26143417058582, 39.09636724563835],
        [86.26441581061792, 39.097580956929036],
        [86.26739755329864, 39.09879459227653],
        [86.27037939862942, 39.10000815167492],
        [86.27336134661189, 39.10122163511829],
        [86.27634339724757, 39.10243504260075],
        [86.27932555053803, 39.103648374116396],
        [86.28230780648478, 39.10486162965932],
        [86.2852901650894, 39.10607480922364],
        [86.28827262635345, 39.107287912803415],
        [86.29125519027843, 39.108500940392766],
        [86.29423785686589, 39.10971389198581],
        [86.29722062611741, 39.110926767576615],
        [86.30020349803448, 39.112139567159275],
        [86.30318647261868, 39.11335229072792],
        [86.30616954987151, 39.1145649382766],
        [86.30915272979455, 39.11577750979945],
        [86.31213601238929, 39.11699000529056],
        [86.31511939765728, 39.118202424744],
        [86.3181028856001, 39.119414768153895],
        [86.32108647621918, 39.12062703551433],
        [86.32407016951616, 39.121839226819404],
        [86.3270539654925, 39.123051342063214],
        [86.33003786414973, 39.12426338123983],
        [86.33302186548941, 39.12547534434338],
        [86.33600596951307, 39.126687231367924],
        [86.33899017622217, 39.12789904230761],
        [86.3419744856183, 39.12911077715648],
        [86.34495889770294, 39.13032243590866],
        [86.34794341247762, 39.13153401855823],
        [86.35092802994386, 39.132745525099274],
        [86.35391275010319, 39.13395695552592],
        [86.35689757295712, 39.13516830983223],
        [86.35988249850716, 39.13637958801232],
        [86.36286752675483, 39.13759079006025],
        [86.36585265770164, 39.13880191597015],
        [86.36883789134909, 39.14001296573609],
        [86.37182322769868, 39.14122393935217],
        [86.37480866675196, 39.142434836812484],
        [86.37779420851041, 39.143645658111126],
        [86.38077985297552, 39.14485640324218],
        [86.38376560014883, 39.14606707219975],
        [86.38675145003184, 39.14727766497791],
        [86.38973740262601, 39.14848818157078],
        [86.3927234579329, 39.14969862197241],
        [86.39570961595395, 39.150908986176944],
        [86.39869587669071, 39.15211927417842],
        [86.40168224014464, 39.15332948597097],
        [86.40466870631725, 39.15453962154866],
        [86.40765527521006, 39.15574968090559],
        [86.41064194682453, 39.15695966403586],
        [86.41362872116215, 39.158169570933545],
        [86.41661559822441, 39.159379401592744],
        [86.41960257801283, 39.16058915600754],
        [86.42258966052889, 39.161798834172025],
        [86.42557684577403, 39.16300843608028],
        [86.42856413374979, 39.16421796172642],
        [86.43155152445765, 39.165427411104524],
        [86.43453901789906, 39.166636784208656],
        [86.43752661407552, 39.16784608103294],
        [86.4405143129885, 39.16905530157144],
        [86.44350211463951, 39.17026444581827],
        [86.44649001902998, 39.171473513767495],
        [86.44947802616144, 39.17268250541322],
        [86.45246613603534, 39.17389142074952],
        [86.45545434865312, 39.175100259770474],
        [86.45844266401633, 39.17630902247019],
        [86.46143108212638, 39.17751770884276],
        [86.46441960298473, 39.178726318882255],
        [86.46740822659292, 39.17993485258277],
        [86.47039695295234, 39.18114330993837],
        [86.47338578206451, 39.18235169094319],
        [86.47637471393087, 39.18355999559127],
        [86.47936374855288, 39.18476822387672],
        [86.48235288593203, 39.18597637579362],
        [86.48534212606975, 39.187184451336066],
        [86.4883314689675, 39.188392450498135],
        [86.49132091462677, 39.189600373273926],
        [86.494310463049, 39.1908082196575],
        [86.49730011423564, 39.19201598964294],
        [86.50028986818815, 39.19322368322437],
        [86.50327972490798, 39.194431300395834],
        [86.5062696843966, 39.19563884115146],
        [86.50925974665542, 39.196846305485295],
        [86.51224991168593, 39.19805369339144],
        [86.51524017948955, 39.19926100486397],
        [86.51823055006774, 39.20046823989698],
        [86.52122102342196, 39.20167539848456],
        [86.52421159955365, 39.20288248062076],
        [86.52720227846423, 39.204089486299715],
        [86.53019306015517, 39.20529641551547],
        [86.53318394462788, 39.206503268262125],
        [86.53617493188383, 39.20771004453377],
        [86.53916602192444, 39.20891674432447],
        [86.54215721475116, 39.2101233676283],
        [86.5451485103654, 39.21132991443938],
        [86.54813990876863, 39.21253638475175],
        [86.55113140996225, 39.21374277855953],
        [86.55412301394772, 39.21494909585679],
        [86.55711472072643, 39.2161553366376],
        [86.56010653029986, 39.217361500896054],
        [86.5630984426694, 39.21856758862622],
        [86.5660904578365, 39.21977359982221],
        [86.56908257580258, 39.22097953447808],
        [86.57207479656904, 39.22218539258792],
        [86.57506712013733, 39.223391174145796],
        [86.57805954650885, 39.22459687914582],
        [86.58105207568505, 39.225802507582046],
        [86.58404470766735, 39.22700805944855],
        [86.58703744245712, 39.228213534739446],
        [86.59003028005581, 39.22941893344879],
        [86.59302322046484, 39.23062425557067],
        [86.5960162636856, 39.231829501099156],
        [86.5990094097195, 39.23303467002834],
        [86.602002658568, 39.23423976235229],
        [86.60499601023247, 39.235444778065094],
        [86.60798946471431, 39.23664971716084],
        [86.61098302201495, 39.23785457963359],
        [86.6139766821358, 39.23905936547743],
        [86.61697044507824, 39.24026407468645],
        [86.61996431084368, 39.24146870725471],
        [86.62295827943355, 39.242673263176286],
        [86.62595235084919, 39.24387774244528],
        [86.62894652509208, 39.245082145055754],
        [86.63194080216354, 39.24628647100179],
        [86.63493518206502, 39.247490720277476],
        [86.63792966479792, 39.248694892876856],
        [86.64092425036357, 39.249898988794044],
        [86.64391893876342, 39.251103008023115],
        [86.64691372999887, 39.25230695055812],
        [86.64990862407124, 39.25351081639316],
        [86.65290362098202, 39.254714605522295],
        [86.65589872073252, 39.25591831793962],
        [86.65889392332414, 39.2571219536392],
        [86.66188922875828, 39.25832551261511],
        [86.66488463703631, 39.25952899486143],
        [86.66788014815965, 39.26073240037225],
        [86.67087576212963, 39.26193572914161],
        [86.67387147894766, 39.26313898116362],
        [86.67686729861511, 39.26434215643234],
        [86.67986322113336, 39.26554525494185],
        [86.68285924650378, 39.26674827668622],
        [86.68585537472774, 39.267951221659544],
        [86.68885160580665, 39.26915408985586],
        [86.69184793974185, 39.27035688126929],
        [86.69484437653469, 39.27155959589386],
        [86.69784091618658, 39.27276223372369],
        [86.70083755869886, 39.273964794752814],
        [86.70383430407293, 39.27516727897534],
        [86.70683115231014, 39.27636968638532],
        [86.70982810341185, 39.27757201697683],
        [86.71282515737938, 39.27877427074395],
        [86.7158223142142, 39.27997644768077],
        [86.71881957391756, 39.28117854778132],
        [86.72181693649088, 39.28238057103971],
        [86.72481440193549, 39.28358251745001],
        [86.72781197025277, 39.284784387006276],
        [86.73080964144407, 39.28598617970258],
        [86.73380741551071, 39.287187895533016],
        [86.73680529245411, 39.288389534491635],
        [86.73980327227557, 39.28959109657252],
        [86.74280135497642, 39.29079258176975],
        [86.74579954055805, 39.29199399007737],
        [86.74879782902184, 39.29319532148949],
        [86.75179622036904, 39.29439657600015],
        [86.75479471460109, 39.29559775360344],
        [86.75779331171927, 39.29679885429342],
        [86.76079201172494, 39.29799987806416],
        [86.76379081461945, 39.29920082490975],
        [86.76678972040415, 39.30040169482424],
        [86.76978872908033, 39.301602487801695],
        [86.7727878406494, 39.30280320383622],
        [86.77578705511262, 39.30400384292184],
        [86.77878637247139, 39.30520440505266],
        [86.78178579272698, 39.30640489022274],
        [86.78478531588077, 39.30760529842614],
        [86.78778494193406, 39.30880562965695],
        [86.79078467088823, 39.310005883909206],
        [86.79378450274454, 39.31120606117702],
        [86.79678443750434, 39.31240616145442],
        [86.79978447516899, 39.313606184735505],
        [86.80278461573977, 39.31480613101434],
        [86.80578485921802, 39.316006000284965],
        [86.80878520560505, 39.317205792541486],
        [86.81178565490221, 39.31840550777797],
        [86.81478620711081, 39.31960514598845],
        [86.81778686223213, 39.320804707167],
        [86.82078762026752, 39.32200419130774],
        [86.82378848121827, 39.32320359840467],
        [86.82678944508574, 39.324402928451896],
        [86.8297905118712, 39.32560218144348],
        [86.83279168157597, 39.32680135737349],
        [86.83579295420137, 39.328000456235976],
        [86.83879432974868, 39.32919947802504],
        [86.84179580821923, 39.33039842273471],
        [86.84479738961434, 39.33159729035906],
        [86.84779907393528, 39.33279608089219],
        [86.85080086118339, 39.333994794328135],
        [86.85380275135994, 39.33519343066096],
        [86.85680474446622, 39.33639198988473],
        [86.85980684050358, 39.337590471993536],
        [86.86280903947328, 39.338788876981425],
        [86.86581134137661, 39.33998720484246],
        [86.86881374621488, 39.34118545557072],
        [86.8718162539894, 39.34238362916025],
        [86.87481886470142, 39.34358172560513],
        [86.87782157835227, 39.34477974489942],
        [86.88082439494322, 39.345977687037184],
        [86.8838273144756, 39.347175552012494],
        [86.88683033695061, 39.34837333981941],
        [86.88983346236961, 39.349571050451985],
        [86.89283669073384, 39.3507686839043],
        [86.89584002204462, 39.35196624017041],
        [86.89884345630323, 39.35316371924437],
        [86.90184699351092, 39.35436112112026],
        [86.90485063366897, 39.35555844579213],
        [86.9078543767787, 39.35675569325407],
        [86.91085822284134, 39.3579528635001],
        [86.9138621718582, 39.35914995652433],
        [86.91686622383054, 39.36034697232078],
        [86.91987037875961, 39.36154391088353],
        [86.9228746366467, 39.36274077220665],
        [86.9258789974931, 39.3639375562842],
        [86.92888346130006, 39.36513426311022],
        [86.93188802806885, 39.3663308926788],
        [86.93489269780072, 39.367527444984006],
        [86.93789747049695, 39.36872392001987],
        [86.94090234615881, 39.369920317780476],
        [86.94390732478756, 39.37111663825987],
        [86.94691240638443, 39.37231288145212],
        [86.94991759095073, 39.373509047351284],
        [86.95292287848767, 39.37470513595144],
        [86.95592826899653, 39.37590114724664],
        [86.95893376247858, 39.37709708123092],
        [86.96193935893506, 39.37829293789837],
        [86.96494505836719, 39.37948871724304],
        [86.96795086077627, 39.380684419259],
        [86.97095676616354, 39.381880043940285],
        [86.97396277453024, 39.38307559128098],
        [86.9769688858776, 39.38427106127513],
        [86.97997510020689, 39.3854664539168],
        [86.98298141751935, 39.38666176920005],
        [86.98598783781623, 39.38785700711894],
        [86.98899436109873, 39.389052167667515],
        [86.99200098736816, 39.39024725083985],
        [86.99500771662572, 39.39144225663],
        [86.99801454887265, 39.392637185032015],
        [87.00102148411018, 39.393832036039974],
        [87.00402852233957, 39.395026809647916],
        [87.00703566356202, 39.396221505849915],
        [87.01004290777878, 39.39741612464],
        [87.0130502549911, 39.398610666012246],
        [87.01605770520017, 39.39980512996073],
        [87.01906525840728, 39.40099951647947],
        [87.02207291461359, 39.40219382556257],
        [87.02508067382036, 39.40338805720403],
        [87.02808853602882, 39.40458221139796],
        [87.03109650124017, 39.40577628813839],
        [87.03410456945564, 39.406970287419384],
        [87.03711274067648, 39.40816420923499],
        [87.04012101490386, 39.40935805357927],
        [87.04312939213905, 39.41055182044627],
        [87.04613787238323, 39.411745509830084],
        [87.04914645563763, 39.41293912172472],
        [87.05215514190344, 39.41413265612426],
        [87.05516393118191, 39.41532611302274],
        [87.05817282347422, 39.416519492414245],
        [87.06118181878163, 39.41771279429281],
        [87.0641909171053, 39.41890601865249],
        [87.06720011844645, 39.420099165487336],
        [87.07020942280629, 39.42129223479143],
        [87.073218830186, 39.4224852265588],
        [87.07622834058682, 39.423678140783494],
        [87.07923795400994, 39.424870977459584],
        [87.08224767045657, 39.42606373658112],
        [87.08525748992788, 39.42725641814216],
        [87.08826741242508, 39.428449022136746],
        [87.0912774379494, 39.429641548558955],
        [87.094287566502, 39.4308339974028],
        [87.09729779808407, 39.43202636866238],
        [87.10030813269682, 39.43321866233171],
        [87.10331857034147, 39.43441087840487],
        [87.10632911101915, 39.4356030168759],
        [87.10933975473108, 39.436795077738864],
        [87.11235050147843, 39.437987060987794],
        [87.11536135126242, 39.43917896661675],
        [87.1183723040842, 39.44037079461981],
        [87.121383359945, 39.44156254499099],
        [87.12439451884593, 39.44275421772436],
        [87.12740578078822, 39.44394581281395],
        [87.13041714577307, 39.44513733025386],
        [87.13342861380158, 39.446328770038086],
        [87.13644018487501, 39.44752013216072],
        [87.1394518589945, 39.44871141661579],
        [87.14246363616122, 39.44990262339736],
        [87.14547551637634, 39.45109375249947],
        [87.14848749964106, 39.45228480391618],
        [87.15149958595651, 39.453475777641536],
        [87.15451177532388, 39.45466667366959],
        [87.15752406774433, 39.455857491994394],
        [87.16053646321906, 39.457048232609985],
        [87.16354896174919, 39.45823889551043],
        [87.16656156333589, 39.45942948068977],
        [87.16957426798034, 39.46061998814207],
        [87.17258707568368, 39.46181041786136],
        [87.17559998644711, 39.46300076984168],
        [87.17861300027172, 39.46419104407712],
        [87.18162611715873, 39.46538124056169],
        [87.18463933710927, 39.46657135928944],
        [87.1876526601245, 39.46776140025445],
        [87.19066608620555, 39.46895136345075],
        [87.19367961535362, 39.47014124887237],
        [87.19669324756978, 39.4713310565134],
        [87.19970698285528, 39.47252078636786],
        [87.20272082121119, 39.473710438429784],
        [87.20573476263867, 39.474900012693254],
        [87.2087488071389, 39.476089509152295],
        [87.211762954713, 39.47727892780097],
        [87.21477720536208, 39.4784682686333],
        [87.21779155908735, 39.47965753164338],
        [87.22080601588986, 39.4808467168252],
        [87.22382057577086, 39.48203582417285],
        [87.22683523873137, 39.48322485368036],
        [87.22985000477262, 39.48441380534177],
        [87.23286487389568, 39.48560267915113],
        [87.23587984610171, 39.48679147510251],
        [87.23889492139182, 39.48798019318991],
        [87.24191009976718, 39.489168833407426],
        [87.2449253812289, 39.49035739574907],
        [87.24794076577808, 39.4915458802089],
        [87.25095625341588, 39.49273428678095],
        [87.25397184414341, 39.49392261545929],
        [87.25698753796179, 39.49511086623794],
        [87.26000333487217, 39.49629903911095],
        [87.2630192348756, 39.49748713407237],
        [87.26603523797328, 39.49867515111626],
        [87.26905134416629, 39.49986309023663],
        [87.27206755345576, 39.50105095142756],
        [87.27508386584276, 39.50223873468307],
        [87.27810028132846, 39.50342643999721],
        [87.28111679991396, 39.50461406736403],
        [87.28413342160034, 39.505801616777575],
        [87.28715014638874, 39.50698908823187],
        [87.29016697428025, 39.50817648172098],
        [87.29318390527601, 39.50936379723894],
        [87.29620093937706, 39.5105510347798],
        [87.29921807658458, 39.51173819433759],
        [87.30223531689963, 39.51292527590636],
        [87.30525266032332, 39.51411227948015],
        [87.30827010685674, 39.51529920505301],
        [87.311287656501, 39.51648605261897],
        [87.31430530925718, 39.5176728221721],
        [87.3173230651264, 39.51885951370641],
        [87.32034092410976, 39.520046127215956],
        [87.32335888620833, 39.52123266269478],
        [87.3263769514232, 39.52241912013692],
        [87.32939511975546, 39.52360549953642],
        [87.33241339120623, 39.52479180088733],
        [87.33543176577658, 39.52597802418368],
        [87.33845024346759, 39.5271641694195],
        [87.34146882428034, 39.52835023658886],
        [87.34448750821593, 39.52953622568577],
        [87.34750629527542, 39.5307221367043],
        [87.35052518545993, 39.53190796963848],
        [87.3535441787705, 39.53309372448234],
        [87.35656327520823, 39.534279401229924],
        [87.3595824747742, 39.53546499987529],
        [87.36260177746945, 39.53665052041244],
        [87.36562118329509, 39.53783596283546],
        [87.36864069225221, 39.539021327138364],
        [87.37166030434183, 39.540206613315185],
        [87.37468001956505, 39.54139182135999],
        [87.37769983792292, 39.54257695126678],
        [87.38071975941655, 39.54376200302963],
        [87.38373978404694, 39.54494697664255],
        [87.38675991181522, 39.54613187209961],
        [87.38978014272242, 39.54731668939481],
        [87.3928004767696, 39.548501428522236],
        [87.39582091395783, 39.549686089475884],
        [87.39884145428816, 39.550870672249815],
        [87.40186209776168, 39.552055176838046],
        [87.4048828443794, 39.55323960323466],
        [87.40790369414239, 39.55442395143363],
        [87.41092464705173, 39.55560822142904],
        [87.41394570310842, 39.55679241321492],
        [87.41696686231357, 39.5579765267853],
        [87.41998812466821, 39.55916056213421],
        [87.42300949017336, 39.560344519255715],
        [87.4260309588301, 39.56152839814383],
        [87.42905253063947, 39.56271219879259],
        [87.43207420560249, 39.56389592119602],
        [87.43509598372023, 39.5650795653482],
        [87.43811786499374, 39.566263131243126],
        [87.441139849424, 39.56744661887485],
        [87.44416193701213, 39.56863002823741],
        [87.44718412775913, 39.56981335932483],
        [87.45020642166601, 39.57099661213116],
        [87.45322881873383, 39.57217978665043],
        [87.45625131896364, 39.573362882876665],
        [87.45927392235643, 39.57454590080392],
        [87.4622966289133, 39.57572884042622],
        [87.46531943863518, 39.5769117017376],
        [87.46834235152319, 39.578094484732084],
        [87.47136536757831, 39.579277189403726],
        [87.47438848680157, 39.58045981574655],
        [87.47741170919399, 39.58164236375459],
        [87.48043503475661, 39.58282483342189],
        [87.48345846349044, 39.58400722474248],
        [87.48648199539649, 39.58518953771036],
        [87.4895056304758, 39.58637177231962],
        [87.49252936872938, 39.587553928564276],
        [87.49555321015822, 39.58873600643834],
        [87.49857715476338, 39.58991800593586],
        [87.50160120254583, 39.59109992705087],
        [87.50462535350661, 39.592281769777394],
        [87.5076496076467, 39.59346353410948],
        [87.51067396496714, 39.59464522004115],
        [87.51369842546893, 39.595826827566455],
        [87.51672298915305, 39.5970083566794],
        [87.51974765602056, 39.59818980737402],
        [87.5227724260724, 39.59937117964437],
        [87.52579729930962, 39.60055247348447],
        [87.52882227573318, 39.60173368888835],
        [87.5318473553441, 39.60291482585003],
        [87.53487253814339, 39.60409588436357],
        [87.53789782413203, 39.60527686442298],
        [87.54092321331103, 39.6064577660223],
        [87.54394870568134, 39.60763858915556],
        [87.546974301244, 39.608819333816776],
      ];

      let idx = 0;
      animateInterval = setInterval(() => {
        if (idx >= testData.length) {
          clearInterval(animateInterval)
          animateInterval = null;
          return;
        }
        let tmpCoord = testData[idx++];
        let targetData = {
          id: globalId++,
          properties: { 时间: "2022-02-28", 运行状态: "在线", 姿态角: "140", 经度: tmpCoord[0], 纬度: tmpCoord[1], 速度: "200KM/H" },
          coordinates: tmpCoord,
          styles: {
            isAlwaysShowPopop: true, //是否一直显示弹窗
          },
        }
        window.mapFrame.postMessage(
          {
            cmd: "addTarget", //在地图中添加站点
            params: {
              target: targetData,
            },
          },
          "*"
        );
      }, 1000)
    }

    function stopAnimate() {
      if (animateInterval != null) {
        clearInterval(animateInterval);
        animateInterval = null;
      }
    }
    //监听iframe窗口传递过来的事件，
    //---当双击地图时，Iframe窗口会发送Map_DblClick消息指令，主窗口通过监听该指令获取要进行双击位置的X,Y坐标
    window.addEventListener("message", (event) => {
      let data = event.data;
      if (!data || !data.cmd) {
        return;
      }
      if (data.cmd === "Map_DblClick") {
        if (!data.params) return;
        let { lon, lat } = data.params;

        // console.log("双击地图位置：", x, y);
        console.log("双击了地图：[", lon, ",", lat, "],")
      }
      else if (data.cmd === "Map_RightClick") {
        if (!data.params) return;
        let { lon, lat } = data.params;

        // console.log("双击地图位置：", x, y);
        console.log("右键点击了地图：[", lon, ",", lat, "],")
      }
      else if (data.cmd === "Station_DragEnd") {
        if (!data.params) return;
        let { id, lon, lat } = data.params;

        // console.log("双击地图位置：", x, y);
        console.log("ID为【" + id + "】的站点被拖动了：" + "[", lon, ",", lat, "],")
      }
      else if (data.cmd === "History_Click") {
        if (!data.params) return;
        let { id, lon, lat } = data.params;

        console.log("ID为【" + id + "】的历史轨迹点被点击了，其坐标为" + "[", lon, ",", lat, "],")
      }
      else if (data.cmd === "Line_Drawn") {
        if (!data.params) return;
        let { coordinates } = data.params;

        console.log("路径绘制完成，坐标为：", coordinates)
      } else if (data.cmd === "Station_DragEnd") {
        debugger
        if (!data.params) return;
        let { id, lon, lat } = data.params;
        console.log("Station_DragEnd:ID为【" + id + "】的站点被拖动了：" + "[" + lon + "," + lat + "],")
      }
    })
  </script>
</body>

</html>